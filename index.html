<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>CoffeeScript 编码风格指南 by geekplux</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/geekplux/coffeescript-style-guide">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/geekplux/coffeescript-style-guide/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/geekplux/coffeescript-style-guide/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>CoffeeScript 编码风格指南</h1>
          <p>CoffeeScript 最佳实践和编码惯例</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/geekplux">geekplux</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h1>
<a name="coffeescript-%E7%BC%96%E7%A0%81%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97" class="anchor" href="#coffeescript-%E7%BC%96%E7%A0%81%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97"><span class="octicon octicon-link"></span></a>CoffeeScript 编码风格指南</h1>

<p>这份指南阐述了一些 <a href="http://jashkenas.github.com/coffee-script/">CoffeeScript</a> 的最佳实践和编码惯例。</p>

<p>这份指南是社群驱动的，非常鼓励大家来贡献内容。</p>

<p>请注意这还是一份正在完善的指南：仍有很多地方可以改进，有些已制定的准则也不一定是社区惯用的（基于此，在适当的情况下，这些有待斟酌的准则将有可能被修改或删除。）</p>

<h2>
<a name="%E7%81%B5%E6%84%9F" class="anchor" href="#%E7%81%B5%E6%84%9F"><span class="octicon octicon-link"></span></a>灵感</h2>

<p>本指南中的很多细节受到了几份现有的风格指南和其他资源的启发。特别是：</p>

<ul>
<li>
<a href="http://www.python.org/dev/peps/pep-0008/">PEP-8</a>: Style Guide for Python Code</li>
<li>Bozhidar Batsov's <a href="https://github.com/bbatsov/ruby-style-guide">Ruby Style Guide</a>
</li>
<li><a href="http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml">Google's JavaScript Style Guide</a></li>
<li><a href="http://arcturo.github.com/library/coffeescript/04_idioms.html">Common CoffeeScript Idioms</a></li>
<li>Thomas Reynolds' <a href="http://awardwinningfjords.com/2011/05/13/coffeescript-specific-style-guide.html">CoffeeScript-specific Style Guide</a>
</li>
<li>Jeremy Ashkenas' <a href="https://gist.github.com/1005723">code review</a> of <a href="http://spinejs.com/">Spine</a>
</li>
<li>The <a href="https://github.com/jashkenas/coffee-script/wiki/FAQ">CoffeeScript FAQ</a>
</li>
</ul><h2>
<a name="%E7%9B%AE%E5%BD%95" class="anchor" href="#%E7%9B%AE%E5%BD%95"><span class="octicon octicon-link"></span></a>目录</h2>

<ul>
<li>
<a href="#guide">CoffeeScript 风格指南</a>

<ul>
<li>
<a href="#code_layout">代码布局（Code Layout）</a>

<ul>
<li><a href="#tabs_or_spaces">Tab 还是 空格？（Tabs or Spaces?）</a></li>
<li><a href="#maximum_line_length">最大行宽（Maximum Line Length）</a></li>
<li><a href="#blank_lines">空行（Blank Lines）</a></li>
<li><a href="#trailing_whitespace">结尾空白（Trailing Whitespace）</a></li>
<li><a href="#optional_commas">可选的逗号（Optional Commas）</a></li>
<li><a href="#encoding">编码（Encoding）</a></li>
</ul>
</li>
<li><a href="#module_imports">模块导入（Module Imports）</a></li>
<li><a href="#whitespace">表达式和语句中的空白（Whitespace in Expressions and Statements）</a></li>
<li>
<a href="#comments">注释（Comments）</a>

<ul>
<li><a href="#block_comments">块注释（Block Comments）</a></li>
<li><a href="#inline_comments">行内注释（Inline Comments）</a></li>
</ul>
</li>
<li><a href="#naming_conventions">命名规范（Naming Conventions）</a></li>
<li><a href="#functions">函数（Functions）</a></li>
<li><a href="#strings">字符串（Strings）</a></li>
<li><a href="#conditionals">条件判断（Conditionals）</a></li>
<li><a href="#looping_and_comprehensions">循环和列表解析（Looping and Comprehensions）</a></li>
<li><a href="#extending_native_objects">扩展本地对象（Extending Native Objects）</a></li>
<li><a href="#exceptions">异常（Exceptions）</a></li>
<li><a href="#annotations">注解（Annotations）</a></li>
<li><a href="#miscellaneous">其他（Miscellaneous）</a></li>
</ul>
</li>
</ul><p><a name="code_layout"></a></p>

<h2>
<a name="%E4%BB%A3%E7%A0%81%E5%B8%83%E5%B1%80code-layout" class="anchor" href="#%E4%BB%A3%E7%A0%81%E5%B8%83%E5%B1%80code-layout"><span class="octicon octicon-link"></span></a>代码布局（Code Layout）</h2>

<p><a name="tabs_or_spaces"></a></p>

<h3>
<a name="tab-%E8%BF%98%E6%98%AF-%E7%A9%BA%E6%A0%BCtabs-or-spaces" class="anchor" href="#tab-%E8%BF%98%E6%98%AF-%E7%A9%BA%E6%A0%BCtabs-or-spaces"><span class="octicon octicon-link"></span></a>Tab 还是 空格？（Tabs or Spaces?）</h3>

<p>只用 <strong>空格</strong>，每级缩进均为 <strong>2 个空格</strong>。切勿混用 Tab 和空格。</p>

<p><a name="maximum_line_length"></a></p>

<h3>
<a name="%E6%9C%80%E5%A4%A7%E8%A1%8C%E5%AE%BDmaximum-line-length" class="anchor" href="#%E6%9C%80%E5%A4%A7%E8%A1%8C%E5%AE%BDmaximum-line-length"><span class="octicon octicon-link"></span></a>最大行宽（Maximum Line Length）</h3>

<p>限制每行最多 79 个字符。</p>

<p><a name="blank_lines"></a></p>

<h3>
<a name="%E7%A9%BA%E8%A1%8Cblank-lines" class="anchor" href="#%E7%A9%BA%E8%A1%8Cblank-lines"><span class="octicon octicon-link"></span></a>空行（Blank Lines）</h3>

<p>顶级函数和类的定义用一个空行分开。</p>

<p>类内部的函数定义也用一个空行分开。</p>

<p>对于每个函数体内，只在为了提高可读性的情况下才使用一个空行（例如：为了达到划分逻辑的目的）。</p>

<p><a name="trailing_whitespace"></a></p>

<h3>
<a name="%E7%BB%93%E5%B0%BE%E7%A9%BA%E7%99%BDtrailing-whitespace" class="anchor" href="#%E7%BB%93%E5%B0%BE%E7%A9%BA%E7%99%BDtrailing-whitespace"><span class="octicon octicon-link"></span></a>结尾空白（Trailing Whitespace）</h3>

<p>不要在任何一行保留行尾空白。</p>

<p><a name="optional_commas"></a></p>

<h3>
<a name="%E5%8F%AF%E9%80%89%E7%9A%84%E9%80%97%E5%8F%B7optional-commas" class="anchor" href="#%E5%8F%AF%E9%80%89%E7%9A%84%E9%80%97%E5%8F%B7optional-commas"><span class="octicon octicon-link"></span></a>可选的逗号（Optional Commas）</h3>

<p>当对象（或数组）的属性（或元素）作为单独一行列出时，避免在换行符前使用逗号。如下：</p>

<div class="highlight highlight-coffeescript"><pre><span class="c1"># 好</span>
<span class="nv">foo = </span><span class="p">[</span>
  <span class="s">'some'</span>
  <span class="s">'string'</span>
  <span class="s">'values'</span>
<span class="p">]</span>
<span class="nv">bar:</span>
  <span class="nv">label: </span><span class="s">'test'</span>
  <span class="nv">value: </span><span class="mi">87</span>

<span class="c1"># 差</span>
<span class="nv">foo = </span><span class="p">[</span>
  <span class="s">'some'</span><span class="p">,</span>
  <span class="s">'string'</span><span class="p">,</span>
  <span class="s">'values'</span>
<span class="p">]</span>
<span class="nv">bar:</span>
  <span class="nv">label: </span><span class="s">'test'</span><span class="p">,</span>
  <span class="nv">value: </span><span class="mi">87</span>
</pre></div>

<p><a name="encoding"></a></p>

<h3>
<a name="%E7%BC%96%E7%A0%81encoding" class="anchor" href="#%E7%BC%96%E7%A0%81encoding"><span class="octicon octicon-link"></span></a>编码（Encoding）</h3>

<p>UTF-8 是首选的源文件编码。</p>

<p><a name="module_imports"></a></p>

<h2>
<a name="%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5module-imports" class="anchor" href="#%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5module-imports"><span class="octicon octicon-link"></span></a>模块导入（Module Imports）</h2>

<p>如果需要导入模块 (CommonJS 模块，AMD，等等.), <code>require</code> 语句应该单独作为一行。如下：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nx">require</span> <span class="s">'lib/setup'</span>
<span class="nv">Backbone = </span><span class="nx">require</span> <span class="s">'backbone'</span>
</pre></div>

<p>这些语句应该按以下顺序去分组：</p>

<ol>
<li>标准库的导入 <em>（如果标准库存在）</em>
</li>
<li>第三方库的导入</li>
<li>本地导入 <em>（导入这个应用程序的或库的具体依赖）</em>
</li>
</ol><p><a name="whitespace"></a></p>

<h2>
<a name="%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%92%8C%E8%AF%AD%E5%8F%A5%E4%B8%AD%E7%9A%84%E7%A9%BA%E7%99%BDwhitespace-in-expressions-and-statements" class="anchor" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%92%8C%E8%AF%AD%E5%8F%A5%E4%B8%AD%E7%9A%84%E7%A9%BA%E7%99%BDwhitespace-in-expressions-and-statements"><span class="octicon octicon-link"></span></a>表达式和语句中的空白（Whitespace in Expressions and Statements）</h2>

<p>下列情况应该避免多余的空格：</p>

<ul>
<li>
<p>紧贴着圆括号、方括号和大括号内部</p>

<div class="highlight highlight-coffeescript"><pre>   <span class="p">(</span><span class="nx">$</span> <span class="s">'body'</span><span class="p">)</span> <span class="c1"># 好</span>
   <span class="p">(</span> <span class="nx">$</span> <span class="s">'body'</span> <span class="p">)</span> <span class="c1"># 差</span>
</pre></div>
</li>
<li>
<p>紧贴在逗号前</p>

<div class="highlight highlight-coffeescript"><pre>   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span> <span class="c1"># 好</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">x</span> <span class="p">,</span> <span class="nx">y</span> <span class="c1"># 差</span>
</pre></div>
</li>
</ul><p>额外建议：</p>

<ul>
<li>
<p>在下列二元操作符的左右两边都保留 <strong>一个空格</strong></p>

<ul>
<li>
<p>赋值运算符: <code>=</code></p>

<ul>
<li>
<p><em>注意这同样适用于函数定义中的默认参数</em></p>

<div class="highlight highlight-coffeescript"><pre><span class="nv">test: </span><span class="nf">(param = null) -&gt;</span> <span class="c1"># 好</span>
<span class="nv">test: </span><span class="nf">(param=null) -&gt;</span> <span class="c1"># 差</span>
</pre></div>
</li>
</ul>
</li>
<li><p>自增运算符: <code>+=</code>, <code>-=</code>, 等等。</p></li>
<li>比较运算符: <code>==</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>unless</code>, 等等。</li>
<li><p>算术运算符: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, 等等。</p></li>
<li>
<p><em>（这些操作符两边的空格不要多于一个）</em></p>

<div class="highlight highlight-coffeescript"><pre>   <span class="c1"># 好</span>
   <span class="nv">x = </span><span class="mi">1</span>
   <span class="nv">y = </span><span class="mi">1</span>
   <span class="nv">fooBar = </span><span class="mi">3</span>

   <span class="c1"># 差</span>
   <span class="nv">x      = </span><span class="mi">1</span>
   <span class="nv">y      = </span><span class="mi">1</span>
   <span class="nv">fooBar = </span><span class="mi">3</span>
</pre></div>
</li>
</ul>
</li>
</ul><p><a name="comments"></a></p>

<h2>
<a name="%E6%B3%A8%E9%87%8Acomments" class="anchor" href="#%E6%B3%A8%E9%87%8Acomments"><span class="octicon octicon-link"></span></a>注释（Comments）</h2>

<p>如果你修改了一段已有注释说明的代码，则也要更新它对应的注释。（理想状态是，重构这段代码直到它不需要注释说明，然后再把之前的注释全删掉。）</p>

<p>注释的首字母要大写，除非第一个单词是以小写字母开头的标识符。</p>

<p>如果注释很短，可以省略末尾的句号。</p>

<p><a name="block_comments"></a></p>

<h3>
<a name="%E5%9D%97%E6%B3%A8%E9%87%8Ablock-comments" class="anchor" href="#%E5%9D%97%E6%B3%A8%E9%87%8Ablock-comments"><span class="octicon octicon-link"></span></a>块注释（Block Comments）</h3>

<p>注释块通常应用于尾随其后的一段代码。</p>

<p>每一行注释都以 <code>#</code> 加一个空格开头，而且和被注释的代码有相同的缩进层次。</p>

<p>注释块内的段落以仅含单个 <code>#</code> 的行分割。</p>

<div class="highlight highlight-coffeescript"><pre>  <span class="c1"># 这是一个块注释。请注意假如这是一段块注释，</span>
  <span class="c1"># 则它描述的就应该是接下来的这段代码。</span>
  <span class="c1">#</span>
  <span class="c1"># 这是块注释的第二段。</span>
  <span class="c1"># 请注意这段是由上一行带有 # 号的空行分开的。（P.S. 最好用英文写注释）</span>

  <span class="nx">init</span><span class="p">()</span>
  <span class="nx">start</span><span class="p">()</span>
  <span class="nx">stop</span><span class="p">()</span>
</pre></div>

<p><a name="inline_comments"></a></p>

<h3>
<a name="%E8%A1%8C%E5%86%85%E6%B3%A8%E9%87%8Ainline-comments" class="anchor" href="#%E8%A1%8C%E5%86%85%E6%B3%A8%E9%87%8Ainline-comments"><span class="octicon octicon-link"></span></a>行内注释（Inline Comments）</h3>

<p>行内注释紧贴在被描述的代码的上一行，如果行内注释足够短，则可以处在同一行行尾（由一个空格隔开）。</p>

<p>所有行内注释都以 <code>#</code> 加一个空格开头。</p>

<p>应该限制行内注释的使用，因为它们的存在通常是一个代码异味的标志。</p>

<p>不要给显而易见的情况作行内注释：</p>

<div class="highlight highlight-coffeescript"><pre>  <span class="c1"># 差</span>
  <span class="nv">x = </span><span class="nx">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># x 自增</span>
</pre></div>

<p>然而，行内注释在某些情况下是有用的：</p>

<div class="highlight highlight-coffeescript"><pre>  <span class="c1"># 好</span>
  <span class="nv">x = </span><span class="nx">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># 边界补足</span>
</pre></div>

<p><a name="naming_conventions"></a></p>

<h2>
<a name="%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83naming-conventions" class="anchor" href="#%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83naming-conventions"><span class="octicon octicon-link"></span></a>命名规范（Naming Conventions）</h2>

<p>使用 <code>小驼峰命名法</code> （第一个词的首字母小写，后面每个词的首字母大写）来命名所有的变量、方法和对象属性。</p>

<p>使用 <code>大驼峰命名法</code> （第一个词的首字母，以及后面每个词的首字母都大写）来命名所有的类 <em>（在<a href="http://en.wikipedia.org/wiki/CamelCase#Variations_and_synonyms">其他类似的命名法</a>中，这种风格通常也被称为 <code>帕斯卡命名法（PascalCase）</code>、 <code>大写驼峰命名法（CamelCaps）</code> 或 <code>首字母大写命名法（CapWords）</code>。）</em></p>

<p><em>（CoffeeScript <strong>官方</strong>  约定是用驼峰命名法，因为这可以简化与 JavaScript 的相互转化，想了解更多，请看<a href="https://github.com/jashkenas/coffee-script/issues/425">这里</a>.)</em></p>

<p>对于常量，单词全部大写，用下划线隔开即可：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nx">CONSTANT_LIKE_THIS</span>
</pre></div>

<p>私有函数和私有变量都应该在前面加一个下划线：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nv">_privateMethod: </span><span class="nf">-&gt;</span>
</pre></div>

<p><a name="functions"></a></p>

<h2>
<a name="%E5%87%BD%E6%95%B0functions" class="anchor" href="#%E5%87%BD%E6%95%B0functions"><span class="octicon octicon-link"></span></a>函数（Functions）</h2>

<p><em>（以下这些准则同样适用于类中的方法。）</em></p>

<p>当声明一个带参函数时，应在参数列表的右圆括号后空出一个空格：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nv">foo = </span><span class="nf">(arg1, arg2) -&gt;</span> <span class="c1"># 好</span>
<span class="nv">foo = </span><span class="nf">(arg1, arg2)-&gt;</span> <span class="c1"># 差</span>
</pre></div>

<p>无参函数不要用圆括号：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nv">bar = </span><span class="nf">-&gt;</span> <span class="c1"># 好</span>
<span class="nv">bar = </span><span class="nf">() -&gt;</span> <span class="c1"># 差</span>
</pre></div>

<p>当函数链式调用，却在一行放不下时，则把每个函数调用都另起一行，且都缩进一级（即在 <code>.</code> 前加两个空格）。</p>

<div class="highlight highlight-coffeescript"><pre><span class="p">[</span><span class="mi">1</span><span class="p">..</span><span class="mi">3</span><span class="p">]</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nf">(x) -&gt;</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="mi">10</span><span class="p">..</span><span class="mi">12</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nf">(x) -&gt;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">11</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nf">(x, y) -&gt;</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">)</span>
</pre></div>

<p>当调用函数时，我们应该为了提高可读性而去掉圆括号。请记住，「可读性」是我们主观臆断的。只有类似下面几个例子的情况才被社区认为是最佳的：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nx">baz</span> <span class="mi">12</span>

<span class="nx">brush</span><span class="p">.</span><span class="nx">ellipse</span> <span class="nv">x: </span><span class="mi">10</span><span class="p">,</span> <span class="nv">y: </span><span class="mi">20</span> <span class="c1"># 大括号在适当的时候也可以去掉</span>

<span class="nx">foo</span><span class="p">(</span><span class="mi">4</span><span class="p">).</span><span class="nx">bar</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="nx">obj</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">/</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="nx">print</span> <span class="nx">inspect</span> <span class="nx">value</span>

<span class="k">new</span> <span class="nx">Tag</span><span class="p">(</span><span class="k">new</span> <span class="nx">Value</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">),</span> <span class="k">new</span> <span class="nx">Arg</span><span class="p">(</span><span class="nx">c</span><span class="p">))</span>
</pre></div>

<p>有时候你会发现圆括号用来包裹的是函数体（而不是函数的参数）。请看下面的例子（以下简称为「函数体风格」）：</p>

<div class="highlight highlight-coffeescript"><pre><span class="p">(</span><span class="nx">$</span> <span class="s">'#selektor'</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">'klass'</span>

<span class="p">(</span><span class="nx">foo</span> <span class="mi">4</span><span class="p">).</span><span class="nx">bar</span> <span class="mi">8</span>
</pre></div>

<p>这段代码会编译为：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nx">$</span><span class="p">(</span><span class="s">'#selektor'</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">'klass'</span>

<span class="nx">foo</span><span class="p">(</span><span class="mi">4</span><span class="p">).</span><span class="nx">bar</span> <span class="mi">8</span>
</pre></div>

<p>一些习惯链式调用的人会巧用「函数体风格」进行单独初始化：</p>

<div class="highlight highlight-coffeescript"><pre><span class="p">(</span><span class="nx">$</span> <span class="s">'#selektor'</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s">'klass'</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span> <span class="c1"># 单独初始化调用</span>
<span class="p">((</span><span class="nx">$</span> <span class="s">'#selektor'</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">'klass'</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span> <span class="c1"># 全部调用</span>
</pre></div>

<p>「函数体风格」并不得到推荐。但是， <strong>当它适应一些特殊的项目需求时，还是得用它。</strong></p>

<p><a name="strings"></a></p>

<h2>
<a name="%E5%AD%97%E7%AC%A6%E4%B8%B2strings" class="anchor" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2strings"><span class="octicon octicon-link"></span></a>字符串（Strings）</h2>

<p>用字符串插值代替字符串连接符：</p>

<div class="highlight highlight-coffeescript"><pre><span class="s">"this is an </span><span class="si">#{</span><span class="nx">adjective</span><span class="si">}</span><span class="s"> string"</span> <span class="c1"># 好</span>
<span class="s">"this is an "</span> <span class="o">+</span> <span class="nx">adjective</span> <span class="o">+</span> <span class="s">" string"</span> <span class="c1"># 差</span>
</pre></div>

<p>最好用单引号 (<code>''</code>) 而不是双引号 (<code>""</code>) 。除非是插入到另一段现有的字符串中（类似字符串插值）。</p>

<p><a name="conditionals"></a></p>

<h2>
<a name="%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%ADconditionals" class="anchor" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%ADconditionals"><span class="octicon octicon-link"></span></a>条件判断（Conditionals）</h2>

<p>用 <code>unless</code> 来代替 <code>if</code> 的否定情况。</p>

<p>不要用 <code>unless...else</code>， 而用 <code>if...else</code>:</p>

<div class="highlight highlight-coffeescript"><pre>  <span class="c1"># 好</span>
  <span class="k">if</span> <span class="kc">true</span>
    <span class="p">...</span>
  <span class="k">else</span>
    <span class="p">...</span>

  <span class="c1"># 差</span>
  <span class="k">unless</span> <span class="kc">false</span>
    <span class="p">...</span>
  <span class="k">else</span>
    <span class="p">...</span>
</pre></div>

<p>多行的 if/else 语句应该缩进：</p>

<div class="highlight highlight-coffeescript"><pre>  <span class="c1"># 好</span>
  <span class="k">if</span> <span class="kc">true</span>
    <span class="p">...</span>
  <span class="k">else</span>
    <span class="p">...</span>

  <span class="c1"># 差</span>
  <span class="k">if</span> <span class="kc">true</span> <span class="k">then</span> <span class="p">...</span>
  <span class="k">else</span> <span class="p">...</span>
</pre></div>

<p><a name="looping_and_comprehensions"></a></p>

<h2>
<a name="%E5%BE%AA%E7%8E%AF%E5%92%8C%E5%88%97%E8%A1%A8%E8%A7%A3%E6%9E%90looping-and-comprehensions" class="anchor" href="#%E5%BE%AA%E7%8E%AF%E5%92%8C%E5%88%97%E8%A1%A8%E8%A7%A3%E6%9E%90looping-and-comprehensions"><span class="octicon octicon-link"></span></a>循环和列表解析（Looping and Comprehensions）</h2>

<p>尽可能的使用列表解析：</p>

<div class="highlight highlight-coffeescript"><pre>  <span class="c1"># 好</span>
  <span class="nv">result = </span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">name</span> <span class="k">for</span> <span class="nx">item</span> <span class="k">in</span> <span class="nx">array</span><span class="p">)</span>

  <span class="c1"># 差</span>
  <span class="nv">results = </span><span class="p">[]</span>
  <span class="k">for</span> <span class="nx">item</span> <span class="k">in</span> <span class="nx">array</span>
    <span class="nx">results</span><span class="p">.</span><span class="nx">push</span> <span class="nx">item</span><span class="p">.</span><span class="nx">name</span>
</pre></div>

<p>还可以过滤结果：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nv">result = </span><span class="p">(</span><span class="nx">item</span> <span class="k">for</span> <span class="nx">item</span> <span class="k">in</span> <span class="nx">array</span> <span class="k">when</span> <span class="nx">item</span><span class="p">.</span><span class="nx">name</span> <span class="o">is</span> <span class="s">"test"</span><span class="p">)</span>
</pre></div>

<p>遍历对象的键值：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nv">object = one: </span><span class="mi">1</span><span class="p">,</span> <span class="nv">two: </span><span class="mi">2</span>
<span class="nx">alert</span><span class="p">(</span><span class="s">"</span><span class="si">#{</span><span class="nx">key</span><span class="si">}</span><span class="s"> = </span><span class="si">#{</span><span class="nx">value</span><span class="si">}</span><span class="s">"</span><span class="p">)</span> <span class="k">for</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">object</span>
</pre></div>

<p><a name="extending_native_objects"></a></p>

<h2>
<a name="%E6%89%A9%E5%B1%95%E6%9C%AC%E5%9C%B0%E5%AF%B9%E8%B1%A1extending-native-objects" class="anchor" href="#%E6%89%A9%E5%B1%95%E6%9C%AC%E5%9C%B0%E5%AF%B9%E8%B1%A1extending-native-objects"><span class="octicon octicon-link"></span></a>扩展本地对象（Extending Native Objects）</h2>

<p>不要修改本地对象。</p>

<p>比如，不要给 <code>Array.prototype</code> 引入 <code>Array#forEach</code> 。</p>

<p><a name="exceptions"></a></p>

<h2>
<a name="%E5%BC%82%E5%B8%B8exceptions" class="anchor" href="#%E5%BC%82%E5%B8%B8exceptions"><span class="octicon octicon-link"></span></a>异常（Exceptions）</h2>

<p>不要抑制异常抛出。</p>

<p><a name="annotations"></a></p>

<h2>
<a name="%E6%B3%A8%E8%A7%A3annotations" class="anchor" href="#%E6%B3%A8%E8%A7%A3annotations"><span class="octicon octicon-link"></span></a>注解（Annotations）</h2>

<p>必要的时候应该写注解，来指明接下来的代码块具体将干什么。</p>

<p>注解应紧贴在被描述代码的上一行。</p>

<p>注解关键字后面应该跟一个冒号加一个空格，加一个描述性的注释。</p>

<div class="highlight highlight-coffeescript"><pre>  <span class="c1"># FIXME: The client's current state should *not* affect payload processing.</span>
  <span class="nx">resetClientState</span><span class="p">()</span>
  <span class="nx">processPayload</span><span class="p">()</span>
</pre></div>

<p>如果注解不止一行，则下一行缩进两个空格。</p>

<div class="highlight highlight-coffeescript"><pre>  <span class="c1"># TODO: Ensure that the value returned by this call falls within a certain</span>
  <span class="c1">#   range, or throw an exception.</span>
  <span class="nx">analyze</span><span class="p">()</span>
</pre></div>

<p>注解有以下几类：</p>

<ul>
<li>
<code>TODO</code>: 描述缺失的功能，以便日后加入</li>
<li>
<code>FIXME</code>: 描述需要修复的代码</li>
<li>
<code>OPTIMIZE</code>: 描述性能低下，或难以优化的代码</li>
<li>
<code>HACK</code>: 描述一段值得质疑（或很巧妙）的代码</li>
<li>
<code>REVIEW</code>: 描述需要确认其编码意图是否正确的代码</li>
</ul><p>如果你必须自定义一个新的注解类型，则应该把这个注解类型记录在项目的 README 里面。</p>

<p><a name="miscellaneous"></a></p>

<h2>
<a name="%E5%85%B6%E4%BB%96miscellaneous" class="anchor" href="#%E5%85%B6%E4%BB%96miscellaneous"><span class="octicon octicon-link"></span></a>其他（Miscellaneous）</h2>

<p><code>and</code> 更优于 <code>&amp;&amp;</code>.</p>

<p><code>or</code> 更优于 <code>||</code>.</p>

<p><code>is</code> 更优于 <code>==</code>.</p>

<p><code>not</code> 更优于 <code>!</code>.</p>

<p><code>or=</code> 应在可能的情况下使用：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nx">temp</span> <span class="o">or=</span> <span class="p">{}</span> <span class="c1"># 好</span>
<span class="nv">temp = </span><span class="nx">temp</span> <span class="o">||</span> <span class="p">{}</span> <span class="c1"># 差</span>
</pre></div>

<p>最好用 (<code>::</code>) 访问对象的原型：</p>

<div class="highlight highlight-coffeescript"><pre><span class="nb">Array</span><span class="o">::</span><span class="nx">slice</span> <span class="c1"># 好</span>
<span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span> <span class="c1"># 差</span>
</pre></div>

<p>最好用 <code>@property</code> 而不是 <code>this.property</code>.</p>

<div class="highlight highlight-coffeescript"><pre><span class="k">return</span> <span class="nx">@property</span> <span class="c1"># 好</span>
<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">property</span> <span class="c1"># 差</span>
</pre></div>

<p>但是，避免使用 <strong>单独的</strong> <code>@</code>:</p>

<div class="highlight highlight-coffeescript"><pre><span class="k">return</span> <span class="k">this</span> <span class="c1"># 好</span>
<span class="k">return</span> <span class="nx">@</span> <span class="c1"># 差</span>
</pre></div>

<p>没有返回值的时候避免使用 <code>return</code> ，其他情况则需要显示 return 。</p>

<p>当函数需要接收可变数量的参数时，使用 splats  (<code>...</code>)。</p>

<div class="highlight highlight-coffeescript"><pre><span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">args</span><span class="p">...</span> <span class="c1"># 好</span>

<span class="nf">(a, b, c, rest...) -&gt;</span> <span class="c1"># 好</span>
</pre></div>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("46481966");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>